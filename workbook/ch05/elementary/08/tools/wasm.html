<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WASM Example</title>
</head>
<body>
    <h1>WebAssembly Function: Compute</h1>
    <p>Enter two integers:</p>
    <input id="a" type="number" placeholder="Enter a" />
    <input id="b" type="number" placeholder="Enter b" />
    <button id="computeButton">Compute</button>
    <p>Result: <span id="result"></span></p>

    <script>
async function loadWasm() {
    try {
        const response = await fetch("print.wasm");
        if (!response.ok) {
            throw new Error(`Failed to fetch WASM: ${response.statusText}`);
        }
        const bytes = await response.arrayBuffer();
        const { instance } = await WebAssembly.instantiate(bytes, {
            env: {
                __linear_memory: new WebAssembly.Memory({ initial: 256 }) // Provide a Memory instance
            }
        });
        return instance;
    } catch (error) {
        console.error("Error loading WASM:", error);
    }
}

document.getElementById('computeButton').addEventListener('click', async () => {
    const instance = await loadWasm();
    if (!instance) return;

    console.log("WASM exports:", instance.exports); // Debugging

    if (!instance.exports.compute) {
        console.error("compute function not found in exports!");
        return;
    }

    const compute = instance.exports.compute;
    const aVal = parseInt(document.getElementById('a').value) || 0;
    const bVal = parseInt(document.getElementById('b').value) || 0;

    document.getElementById('result').textContent = compute(aVal, bVal);
});


</script>
</body>
</html>
